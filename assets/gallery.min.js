class VanillaGallery{constructor(selector,options={}){this.gallery=document.querySelector(selector);this.options=Object.assign({lightBox:!0,showTags:!0},options);this.tags=[];this.init()}
init(){if(!this.gallery)return;const images=this.gallery.querySelectorAll('img');if(images.length===0)return;images.forEach(img=>{const tag=img.dataset.galleryTag;if(tag&&!this.tags.includes(tag))this.tags.push(tag);});if(this.options.showTags)this.createFilterBar();if(this.options.lightBox)this.enableLightbox();}
getVisibleImages(){return Array.from(this.gallery.querySelectorAll('img')).filter(img=>{return img.style.display!=='none'})}
createFilterBar(){const filterBar=document.createElement('div');filterBar.className='filter-bar';const allBtn=document.createElement('button');allBtn.textContent='Tous';allBtn.className='filter-btn';allBtn.dataset.tag='all';filterBar.appendChild(allBtn);this.tags.forEach(tag=>{const btn=document.createElement('button');btn.textContent=tag;btn.className='filter-btn';btn.dataset.tag=tag;filterBar.appendChild(btn)});this.gallery.parentNode.insertBefore(filterBar,this.gallery);filterBar.addEventListener('click',e=>{if(e.target.classList.contains('filter-btn')){const tag=e.target.dataset.tag;this.filterImages(tag);document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));e.target.classList.add('active')}})}
filterImages(tag){const images=this.gallery.querySelectorAll('img');images.forEach(img=>{if(tag==='all'||img.dataset.galleryTag===tag){img.style.display='block'}else{img.style.display='none'}})}
enableLightbox(){const lightbox=document.createElement('div');lightbox.className='lightbox';lightbox.innerHTML=`
      <span class="close" role="button" aria-label="Fermer la modale">&times;</span>
      <img class="lightbox-img" src="" alt="">
      <button class="prev" aria-label="Image précédente">&#10094;</button>
      <button class="next" aria-label="Image suivante">&#10095;</button>
    `;document.body.appendChild(lightbox);const lightboxImg=lightbox.querySelector('.lightbox-img');const closeBtn=lightbox.querySelector('.close');const prevBtn=lightbox.querySelector('.prev');const nextBtn=lightbox.querySelector('.next');let currentVisibleImages=[];let currentIndex=0;const showImage=(index)=>{currentIndex=(index+currentVisibleImages.length)%currentVisibleImages.length;lightboxImg.src=currentVisibleImages[currentIndex].src;lightboxImg.alt=currentVisibleImages[currentIndex].alt};const handleKeyDown=(e)=>{if(e.key==='Escape'){lightbox.style.display='none';document.removeEventListener('keydown',handleKeyDown)}else if(e.key==='ArrowLeft'){showImage(currentIndex-1)}else if(e.key==='ArrowRight'){showImage(currentIndex+1)}};this.gallery.querySelectorAll('img').forEach((img)=>{img.addEventListener('click',()=>{currentVisibleImages=this.getVisibleImages();currentIndex=currentVisibleImages.findIndex(visibleImg=>visibleImg.src===img.src);if(currentIndex!==-1){lightboxImg.src=img.src;lightboxImg.alt=img.alt;lightbox.style.display='flex';document.addEventListener('keydown',handleKeyDown)}})});closeBtn.addEventListener('click',()=>{lightbox.style.display='none';document.removeEventListener('keydown',handleKeyDown)});prevBtn.addEventListener('click',()=>showImage(currentIndex-1));nextBtn.addEventListener('click',()=>showImage(currentIndex+1))}}
document.addEventListener("DOMContentLoaded",function(){new VanillaGallery('.gallery',{lightBox:!0,showTags:!0});window.addEventListener("pagehide",()=>{const lightbox=document.querySelector(".lightbox");if(lightbox)lightbox.remove();})})